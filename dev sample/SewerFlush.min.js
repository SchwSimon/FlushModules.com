(function(a,b){b.global=a;b.doc=a.document;a.$=b;b.mod.main=a.document.getElementById("main");a.$.listen.register("click","app",'function() {if ( e.target.hasAttribute( "data-app" ) ) {return $.app.start( e.target.getAttribute( "data-app" ) );}}',!0);a.onpopstate=b.mod.onpopstate})(window,{url:{ajax:"./call-back/call-back.php",chat:"./data/chat/",data:"./data/",host:"./",users:"./data/users/"},user:{id:1,name:"username",avatar:"avatar.jpg",path:"./data/users/1/"},userReq:{id:1,name:"username",avatar:"avatar.jpg",
path:"./data/users/1/"},userMain:{id:1,name:"username",avatar:"avatar.jpg",path:"./data/users/1/"},hOffset:50,isMe:function(){return this.user&&this.userMain.id===this.user.id?!0:!1},userFriends:{cache:null,get:function(a){if($.user.id){a.bind=a.bind||null;if(this.cache)return a.success(this.cache,$,a.bind),a.complete?a.complete($,a.bind):null;var b=this;$.ajax({data:{call:"friends",req:"get_friends",user_id:$.user.id},success:function(c,d){b.cache=c;a.success(c,d,a.bind)},complete:function(b){a.complete&&
a.complete(b,a.bind)}})}}},global:null,doc:null,key:function(a){if(a.key)return a.key;var b="";switch(1*(a.which||a.keyCode)){case 8:b="Backspace";break;case 13:b="Enter";break;case 16:b="Shift";break;case 17:b="Control";break;case 18:b="Alt";break;case 27:b="Escape";break;case 32:b=" ";break;case 37:b="ArrowLeft";break;case 38:b="ArrowUp";break;case 39:b="ArrowRight";break;case 40:b="ArrowDown"}return b},hasClass:function(a,b){return-1<a.className.split(" ").indexOf(b)},addClass:function(a,b){0>
a.className.split(" ").indexOf(b)&&(a.className+=""===a.className?b:" "+b)},removeClass:function(a,b){var c=a.className.split(" "),d=c.indexOf(b);-1<d&&(c.splice(d,1),a.className=c.join(" "))},toggleClass:function(a,b){return-1<a.className.split(" ").indexOf(b)?$.removeClass(a,b):$.addClass(a,b)},closest:function(a,b){if("."===b.substr(0,1))for(b=b.substr(1);1===a.nodeType;){if(-1<a.className.split(" ").indexOf(b))return a;a=a.parentNode}else for(;1===a.nodeType;){if(a.id===b)return a;a=a.parentNode}return!1},
arrayIndexOfKey:function(a,b,c){for(var d=0,e=a.length;d<e;d++)if(a[d][b]===c)return d;return null},empty:function(a){for(;a.firstChild;)a.removeChild(a.firstChild)},prefix:function(a,b,c){return a?(c=c||".",a=a.split(c),a[0]+b+c+("mp4"===a[1]?"jpg":a[1])):!1},htmlspecialdecode:function(a){return a.replace(/&amp;/g,"&").replace(/&quot;/g,'"').replace(/&lt;/g,"<").replace(/&gt;/g,">")},parseText:function(a){var b="";for(var c=a.indexOf("http");-1<c;){var d=a.substr(c,7);if("http://"===d||"https:/"===
d){var e=a.substr(c).indexOf(" ");-1<e?(d=a.substr(c,e),e=a.substr(c+e)):(d=a.substr(c),e="");d=d.replace(/\n/,"");b+=a.substr(0,c)+'<a class="ov-link" href="'+d+'" target="_blank">'+d+"</a>";a=e}else a=a.substr(7);c=a.indexOf("http")}a=""===b?a:b+e;c=a.indexOf("@");-1<c&&(at_indexEnd=a.substr(c).indexOf(" "),-1<at_indexEnd?(b=a.substr(c,at_indexEnd),e=a.substr(c+at_indexEnd)):(b=a.substr(c),e=""),b=b.replace(/\n/,""),a=a.substr(0,c)+'<a class="ov-link" href="'+this.url.host+"?user="+b.substr(1)+
'" target="_blank">'+b+"</a>"+e);return a.replace(/\n\n/g,'<div class="ov-break-double"></div>').replace(/\n/g,'<div class="ov-break-single"></div>')},time:{serverOffset:null,dayNames:"Sunday Moday Tuesday Wednesday Thursday Friday Saturday".split(" "),monthNames:"January February March April May June July August September October November December".split(" "),toDate:function(a){return new Date(Date.UTC(a[0],a[1]-1,a[2],a[3],a[4],a[5])-this.serverOffset)},past:function(a){var b=(Date.now()-a.getTime())/
1E3;3600>b?(b=Math.ceil(b/60),a=" minute"):172800>b?(b=Math.floor(b/3600),a=" hour"):604800>b?(b=Math.floor(b/86400),a=" day"):2629800>b?(b=Math.floor(b/604800),a=" week"):(b=Math.floor(b/2629800),a=" month");return b+a+(1<b?"s":"")},parse:function(a){a=a?this.toDate(a.split(/[- :]/)):new Date;var b=("0"+a.getDate()).slice(-2)+"."+("0"+(a.getMonth()+1)).slice(-2)+"."+a.getFullYear(),c=("0"+a.getHours()).slice(-2)+":"+("0"+a.getMinutes()).slice(-2);return{obj:a,datetime:b+" - "+c,data:b,time:c,past:this.past(a)}}},
uniqid:function(a){return("undefined"===typeof a?"_":a)+Math.random().toString(36).substr(2,9)},preFileupload:function(a){var b;a.ups="undefined"===typeof a.ups?-1:a.ups;a.max="undefined"===typeof a.max?0:a.max;if(a.files){var c=new FormData;c.append("call",a.call);c.append("req","preFileupload");a.files="undefined"===typeof a.files[0]?[a.files]:a.files;var d=0;for(b=a.files.length;d<b&&a.ups++!==a.max;d++)c.append("files[]",a.files[d]);b=!0}else{a.url=a.url.trim();if(""===a.url)return;d=a.ups===
a.max?0:1;c={call:a.call,req:"preFileupload",url:a.url};b=!1}if(0===d)return $.info("Maximum uploads reached","For this upload the maximum is "+a.max+" files.");this.ajax({data:c,isFile:b,progress:a.progress?a.progress:null,success:function(b,c){b.valid&&a.success(b.valid,c);if(b.invalid){for(var d="",e=0,f=b.invalid.length;e<f;e++)d+="<b>"+b.invalid[e].name+"</b>: "+b.invalid[e].error;c.info("Following files could not be uploaded",d)}},complete:a.complete?a.complete:null})},cookie:{set:function(a,
b,c){if(c="undefined"!==typeof c?c:0){var d=new Date;d.setMilliseconds(d.getMilliseconds()+864E5*c);d="; expires="+d.toUTCString()}else d="";$.doc.cookie=a+"="+encodeURIComponent("string"!==typeof b?JSON.stringify(b):b)+d+"; path=/"},get:function(a){for(var b=$.doc.cookie?$.doc.cookie.split("; "):[],c=0,d=b.length;c<d;c++){var e=b[c].split("="),f=e.slice(1).join("=");'"'===f.charAt(0)&&f.slice(1,-1);if(e[0]===a){e[1]=decodeURIComponent(e[1]);try{e[1]=JSON.parse(e[1])}catch(h){}return e[1]}}return!1},
del:function(a){$.doc.cookie=a+"=; expires=Thu, 01 Jan 1970 00:00:01 GMT; path=/"}},docScroll:{get:function(){return $.global.pageYOffset||$.global.scrollY||$.doc.body.scrollTop||$.doc.documentElement.scrollTop},set:function(a){$.doc.body.scrollTop=a;$.doc.documentElement.scrollTop=a;$.global.scrollTo(0,a)}},ajax:function(a){return this.ajaxTransport.request(this,a.url||this.url.ajax,a.data||null,a.success||null,a.error||null,a.complete||null,a.isFile||!1,a.method||"POST",a.trigger||null,a.triggerTxt||
null,a.triggerNoStyle||null,a.progress||null,a.getRaw||null,a.noError||!1)},ajaxTransport:{trigger:function(a,b,c){if(a){if(a.hasAttribute("data-ajaxtrigger"))return!1;c||$.addClass(a,"ov-submitted");a.setAttribute("data-ajaxtrigger",a.textContent);a.innerHTML='<span class="loading-s1"></span><span class="loading-txt">'+(b?b:"Loading...")+"</span>"}return!0},request:function(a,b,c,d,e,f,h,l,k,g,n,m,p,q){if(this.trigger(k,g,n))return g=new a.global.XMLHttpRequest,m&&(g.upload.addEventListener("progress",
m,!1),g.upload.addEventListener("loadend",function r(){this.removeEventListener("loadend",r,!1);this.removeEventListener("progress",m,!1)},!1)),g.onreadystatechange=this.readyStateChange.bind(g,d,e,f,a,k,p,q,n),"POST"===l?(g.open("POST",b),h||(g.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),c="fm="+encodeURIComponent(JSON.stringify(c)))):g.open("GET",b+"?fm="+encodeURIComponent(JSON.stringify(c))),g.send(c),g},readyStateChange:function(a,b,c,d,e,f,h,l){if(4===
this.readyState){console.log("Response status: "+this.statusText);if(0!==this.status)try{var k=f?{type:null,data:this.response}:JSON.parse(this.response);"error"===k.type?"function"===typeof b&&b(k.data,d):"function"===typeof a&&a(k.data,d);console.log("Server response:");console.log(k)}catch(g){console.log(g),console.log(this.response),h||d.info("Server error","An error occured.<br>Not your fault!<br>Try again in a minute otherwise you have to wait until I got that fixed sorry.. \u00af\\_(\u30c4)_/\u00af")}e&&
e.hasAttribute("data-ajaxtrigger")&&(l||d.removeClass(e,"ov-submitted"),e.textContent=e.getAttribute("data-ajaxtrigger"),e.removeAttribute("data-ajaxtrigger"));if("function"===typeof c)try{c(d)}catch(g){console.log(g)}}}},rsc:{loader:null,fmRessources:null,request:function(a,b,c){if(this.fmRessources[a]&&this.fmRessources[a][b]){c=c||!1;for(var d in this.fmRessources[a][b])c&&"js"===d?this.stackJs(this.fmRessources[a][b][d]):this.load(d,this.fmRessources[a][b][d])}},stack:[],stackJs:function(a){this.stack.push(a)},
stackRelease:function(){for(var a=0,b=this.stack.length;a<b;a++)this.load("js",this.stack[a]);this.stack=[]},load:function(a,b){switch(a){case "js":var c=$.doc.createElement("script");c.setAttribute("async","");c.setAttribute("src",$.url.host+b);break;case "css":c=$.doc.createElement("link");c.setAttribute("rel","stylesheet");c.setAttribute("href",$.url.host+b);break;case "meta":for(var d=0,e=b.length;d<e;d++){c=$.doc.createElement("meta");for(var f in b[d])c.setAttribute(f,b[d][f]);$.doc.head.appendChild(c)}return;
default:return}$.doc.head.appendChild(c)},loadUserMeta:function(){if($.userMain){var a="FlushModules.com -> User: "+$.userMain.name;var b=$.url.host+$.userMain.name;var c=$.userMain.avatar?$.userMain.path+$.userMain.avatar:$.url.host+"css/visuals/flushmodules.jpg"}else a="FlushModules.com",b=$.url.host,c=$.url.host+"css/visuals/flushmodules.jpg";this.load("meta",[{name:"description",content:a},{property:"og:description",content:a},{property:"og:type",content:"website"},{property:"og:url",content:b},
{property:"og:image",content:c}])}},volume:{get:function(){var a=$.cookie.get("fm-vol");return!1===a?.5:a},set:function(a){$.cookie.set("fm-vol",0>a?0:1<a?1:a,365)}},connector:{stack:{},register:function(a,b){"undefined"!==typeof a&&a&&""!==a&&(this.stack[a]||(this.stack[a]=b))},remove:function(a){this.stack[a]&&(this.stack[a]=null,delete this.stack[a])},use:function(a,b){if(this.stack[a])return this.stack[a](b)},is:function(a){return!!this.stack[a]}},info:function(a,b,c){c="function"===typeof c?
c:null;var d=$.doc.createElement("div");d.className="info";d.innerHTML='<div class="info-body"><div class="info-b-aCon"><div class="info-b-aNim"></div></div><div class="info-b-border"></div><div class="info-b-title">'+a+'</div><div class="info-b-content">'+b+'</div><div class="info-b-sub">'+(c?'<div class="info-b-cancel">Cancel</div><div class="info-b-confirm">Confirm</div>':'<div class="info-b-ok">Ok</div>')+"</div></div>";$.doc.activeElement.blur();d.addEventListener("click",function f(a,b){a.stopPropagation();
switch(a.target.className){case "info":b=c?!1:!0;break;case "info-b-confirm":c();case "info-b-cancel":case "info-b-ok":b=!0}b&&(this.removeEventListener("click",f,!1),$.doc.body.removeChild(this))},!1);$.doc.body.appendChild(d);setTimeout(function(){d.setAttribute("style","transform: scale(1)")},50)},searchReact:{reacts:{},reactXhr:null,reactTimeout:null,bind:function(a,b){this.reacts[a]||(this.reacts[a]=b,b.input.setAttribute("data-reactkey",a),b.input.addEventListener("keyup",this.reactInput,!1))},
unBind:function(a){this.reacts[a]&&(this.reacts[a].input.removeEventListener("keyup",this.reactInput,!1),this.reacts[a]=null,delete this.reacts[a])},reactInput:function(){var a=$.searchReact;clearTimeout(a.reactTimeout);a.reactTimeout=setTimeout(a.react.bind(a,this.getAttribute("data-reactkey")),250)},react:function(a){this.reactXhr&&this.reactXhr.abort();var b=this.reacts[a].input.value.trim();1<b.length?(this.reacts[a].before&&this.reacts[a].before(),this.reactXhr=$.ajax({data:{call:this.reacts[a].call,
req:"search",search:b},success:this.reacts[a].success,complete:function(b){b.searchReact.reactXhr=null;b.searchReact.reacts[a].complete&&b.searchReact.reacts[a].complete(b)}})):this.reacts[a].complete&&this.reacts[a].complete($)}},mod:{main:null,statePush:!1,mods:{},modSkipEnd:!1,modStarted:null,modActive:null,modsRequested:"-",modCallback:null,load:function(a,b){0>this.modsRequested.indexOf("-"+a+"-")?(this.modsRequested+=a+"-","function"===typeof b&&(this.modCallback={mod:a,callback:b}),$.rsc.request("module",
a)):"function"===typeof b&&b()},register:function(a,b){b.name="mod"+a;b.end=function(a){if(a)$.mod.modSkipEnd=!1;else if(this.onEnd)this.onEnd()};this.mods[a]=b;if(this.modCallback&&this.modCallback.mod===a)this.modCallback.callback(),this.modCallback=null;else if(this.modStarted===a||null===this.modStarted)this.modStarted=a,this.start(a,!0)},onpopstate:function(){var a=this.location.search;a=a.substr(a.indexOf("mod=")+4);$.mod.statePush=!1;$.mod.start(""===a?"sight":a)},start:function(a,b){if("undefined"===
typeof b){if(this.modStarted===a)return;this.modStarted=a;if("undefined"===typeof this.mods[a])return this.load(a)}this.modActive&&this.modActive.end(this.modSkipEnd);$.empty(this.main);this.modActive=this.mods[a];this.statePush||(this.statePush=!0);this.modActive.init($,this.main,$.isMe(),this.main.hasAttribute("data-main")&&""!==this.main.getAttribute("data-main")?this.main.getAttribute("data-main"):null);this.main.removeAttribute("data-main");this.checkUserReq()},checkUserReq:function(){try{$.app.apps.header.userReq[this.modActive.noUserReq?
"hide":"show"]()}catch(a){$.global.setTimeout(function(){this.$.mod.checkUserReq()},600)}},checkAccess:function(a,b){if(!a){var c=$.userMain?"undefined"!==typeof b&&!b||$.userMain.isFriend?"":'<div class="main-error">You have no access to this Module of  '+$.userMain.name+"</div>":'<div class="main-error">This is a User-Only-Module, you must select a User or Login<br> \u00af\\_(\u30c4)_/\u00af</div>';if(""!==c)return this.modSkipEnd=!0,this.main.innerHTML=c,!1}return!0}},app:{reqs:"-",appStartParam:null,
appStarted:null,apps:{},appsRunning:{},register:function(a,b,c){c=c||!1;this.push_req(b);a.name=b;a.close=function(a){if("undefined"===typeof a&&this.zLayer)return this.zLayer.close();if(this.onClose)this.onClose();this.cKey&&$.connector.remove(this.cKey);$.app.kill(this.starter)};this.apps[b]=a;(this.appStarted===b||c)&&this.start(a,!0,c?b:!1)},push_req:function(a){return 0>this.reqs.indexOf("-"+a+"-")?(this.reqs+=a+"-",!0):!1},start:function(a,b,c,d){if("undefined"===typeof b){var e=a.split(":");
this.appStarted=e[0];this.appStartParam=e[1]&&""!==e[1]?e[1]:null;this.appStarter=e[0]+(e[2]?"_"+e[2]:"");if(this.push_req(e[0]))return $.rsc.request("app",e[0]),this.appStarter;a=this.apps[e[0]];if(!a){var f=this;d=d||0;return 25<d?void 0:$.global.setTimeout(function(){f.start(e.join(":"),b,c,d+1)},500)}}var h=c||this.appStarter;if(!this.appsRunning[h])return a=Object.create(a),a.pid=$.uniqid(""),a.starter=h,this.appsRunning[a.starter]=a,console.log("starting app ( app-> "+a.name+", starter-> "+
a.starter+")"),a.init($,this.appStartParam),h;this.appsRunning[h].init($,this.appStartParam);return h},startViaPid:function(a){for(var b in this.appsRunning)this.appsRunning[b].pid==a&&this.appsRunning[b].init($)},stop:function(a,b){a="undefined"!==typeof b?b+"_"+a:a;this.appsRunning[a]&&this.appsRunning[a].close()},kill:function(a){this.appsRunning[a]&&(console.log("closing app ( app-> "+this.appsRunning[a].name+", starter-> "+a+")"),this.appsRunning[a]=null,delete this.appsRunning[a])}},zLayer:{layers:{},
layer:{app:null,id:null,layer:null,zMin:null,zClose:null,zBody:null,isOpen:!1,onClick:null,onMin:null,onClose:null,open:function(a){if(!this.isOpen){this.isOpen=!0;$.zLayer.zFix();a&&$.doc.body.appendChild(this.layer);$.removeClass(this.layer,"hide");var b=this.layer;setTimeout(function(){b.style.transform="scale(0.2)";this.setTimeout(function(){b.removeAttribute("style")},250)},50)}},eClick:function(a){$.zLayer.layers[$.closest(this,".zLayer-main").getAttribute("data-id")].onClick(a)},eMin:function(a){a.stopPropagation();
$.zLayer.layers[$.closest(this,".zLayer-main").getAttribute("data-id")].min()},eClose:function(a){a.stopPropagation();$.zLayer.layers[$.closest(this,".zLayer-main").getAttribute("data-id")].close()},min:function(){this.isOpen=!1;this.onMin();var a=this.layer;a.setAttribute("style","transform:scale(0.2);border-radius:300px;");setTimeout(function(){a.style.transform="scale(0.2) translate"+["Y(-","Y(","X(-","X("][Math.floor(4*Math.random())]+"3200px)";this.setTimeout(function(){this.$.addClass(a,"hide");
$.zLayer.zUnfix()},250)},250)},close:function(){this.isOpen=!1;this.onClose(!0);this.zBody.removeEventListener("click",this.eClick,!1);this.zMin.removeEventListener("click",this.eMin,!1);this.zClose.removeEventListener("click",this.eClose,!1);var a=this.layer;a.setAttribute("style","transform:scale(0)");setTimeout(function(){a.parentNode.removeChild(a);$.zLayer.zUnfix()},250);$.zLayer.layers[this.id]=null;delete $.zLayer.layers[this.id]}},create:function(a){if(a.zLayer)return a.zLayer.open(!0),!1;
var b=Date.now(),c=$.doc.createElement("div");c.setAttribute("style","transform:translate"+["Y(-","Y(","X(-","X("][Math.floor(4*Math.random())]+"3200px);border-radius:300px");c.className="zLayer";c.innerHTML='<div class="zLayer-back"></div><div class="zLayer-main" data-id="'+b+'"><div class="zLayer-nav"><div class="zLayer-min">_<div class="zLayer-nav-txt">hide</div></div><div class="zLayer-close">X<div class="zLayer-nav-txt">close</div></div></div><div class="zLayer-body">'+(a.zHtml?a.zHtml:"")+"</div></div>";
$.doc.body.appendChild(c);var d=Object.create(this.layer);d.app=a;d.id=b;d.layer=c;d.zMin=c.getElementsByClassName("zLayer-min")[0];d.zClose=c.getElementsByClassName("zLayer-close")[0];d.zBody=c.getElementsByClassName("zLayer-body")[0];d.onClose=a.close.bind(a);d.onClick=a.zClick?a.zClick.bind(a):function(){};d.onMin=a.zMin?a.zMin.bind(a):function(){};d.zBody.addEventListener("click",d.eClick,!1);d.zMin.addEventListener("click",d.eMin,!1);d.zClose.addEventListener("click",d.eClose,!1);this.layers[b]=
d;a.zLayer=d;a.zLayer.open(!1);return!0},zVisible:0,zFix:function(){if(0===this.zVisible)try{var a=$.docScroll.get();$.mod.main.setAttribute("data-zScroll",a);$.addClass($.mod.main,"zFix");$.mod.main.style.top=-(a-$.hOffset)+"px"}catch(c){var b=this;return $.global.setTimeout(function(){b.zFix()},500)}$.docScroll.set(0);this.zVisible++},zUnfix:function(){this.zVisible--;0===this.zVisible?($.removeClass($.mod.main,"zFix"),$.docScroll.set($.mod.main.getAttribute("data-zScroll")),$.mod.main.style.top=
""):$.docScroll.set(0)}},listen:{events:{},register:function(a,b,c,d){"undefined"===typeof this[a]&&(this[a]=function(){},this.events[a]={});("undefined"===typeof d?0:d)||(c=c.toString());this.events[a]["scroll"!==a||b?b:"scrollloader"]=c.substr(c.indexOf("{")+1).slice(0,-1).trim();this.gen(a)},remove:function(a,b){if("undefined"!==typeof b)a="scroll"!==b||a?a:"scrollloader",this.events[b]&&(this.events[b][a]="",delete this.events[b][a],this.gen(b));else for(b in this.events)"undefined"!==typeof this.events[b][a]&&
(this.events[b][a]="",delete this.events[b][a],this.gen(b))},gen:function(a){("resize"===a||"scroll"===a?$.global:$.doc).removeEventListener(a,"resize"===a?this.onResize:"scroll"===a?this.onScroll:this[a],!1);var b="",c;for(c in this.events[a])b+=this.events[a][c];""!==b&&(this[a]=new Function("e",("resize"===a?"this.resizeTimeout = null;":"scroll"===a?"this.scrollTimeout = null;":"")+b),("resize"===a||"scroll"===a?$.global:$.doc).addEventListener(a,"resize"===a?this.onResize:"scroll"===a?this.onScroll:
this[a],!1))},onResize:function(){this.resizeTimeout||(this.resizeTimeout=this.setTimeout($.listen.resize,180))},onScroll:function(){this.scrollTimeout||(this.scrollTimeout=this.setTimeout($.listen.scroll,180))}}});